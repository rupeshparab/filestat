
<div class="row">
  <div class="col-md-6">
    <p><%= @share.value %></p>
    <textarea id="text" class="kv-preview-data file-preview-text file-zoom-detail" title="<%= @share.value %>" readonly="" style="width: 100%; height: 100%; min-height: 640px;"><%= @file %></textarea>

    <br/>
  </div>
  <div class="col-md-6">
    <%= render 'table' %>
    <br/>
  </div>
</div>


<script type="text/javascript">
  $(document).ready(function () {
    $("#table").show();
    var contents = $('#text').text();
    // document.getElementById("bytes").innerText = f.size;
    // document.getElementById("lines").innerText = contents.split("\n").length

    var words;

    var split = contents.trim().split(/\s+/g);
    if (split.length === 1) {
        if (split[0].trim() === '') {
            words = 0;
        } else {
            words = 1;
        }
    } else {
        words = split.length;
    }

    var lines;
    var matching = contents.match(/\n/g);
    if (matching != null) {
        lines = matching.length;
    } else {
            // File has content but no newlines. If file is empty
      // return zero lines, otherwise there is only a single line
      if (text.trim().length == 0) {
          lines = 0;
      } else {
          lines = 1;
      }
    }

    document.getElementById("bytes").innerText = contents.length;
    document.getElementById("words").innerText = words;
    document.getElementById("lines").innerText = lines;
    document.getElementById("chars").innerText = contents.length;
  });


</script>
